---
layout: post
title: How to deduplicate rows in PostgreSQL
date: 2013-09-05 08:49:20.000000000 -07:00
categories:
- Blog
tags: []
status: publish
type: post
published: true
meta:
  _edit_last: '1'
author:
  login: jhund
  email: jhund@clearcove.ca
  display_name: jhund
  first_name: ''
  last_name: ''
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<p>Use the following query to keep only one row and delete all duplicates of that row.</p>
<p>Note: this is non-standard SQL and works only with PostgreSQL.</p>
<p>The following snippet finds all rows in the users table that have identical email and organization_id. It keeps the oldest of the rows (via users.id &gt; u2.id) and deletes the newer duplicates.</p>
<pre>DELETE FROM users USING users u2
 WHERE users.email = u2.email
 AND users.organization_id = u2.organization_id
 AND users.id &gt; u2.id;</pre>
<p>Read the documentation for <a href="http://www.postgresql.org/docs/9.2/static/sql-delete.html">PostgreSQL's USING clause</a> in combination with DELETE.</p>
<p>&nbsp;</p>
